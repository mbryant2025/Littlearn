{"ast":null,"code":"var _jsxFileName = \"/Users/michaelbryant/Desktop/Littlearn/web/src/BluetoothContext.tsx\",\n  _s = $RefreshSig$(),\n  _s2 = $RefreshSig$();\nimport React, { createContext, useContext, useState, useCallback } from 'react';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst BluetoothContext = /*#__PURE__*/createContext(undefined);\nconst PrintFlag = '__P__';\nconst PrintFlagLength = PrintFlag.length;\nconst ErrorFlag = '__ER__';\nconst ErrorFlagLength = ErrorFlag.length;\nconst ScriptSentFlag = '__SS__';\nfunction uuid_bytes_to_string(uuid) {\n  // Assumes LSB first\n  const uuid_str = uuid.reverse().map(byte => byte.toString(16).padStart(2, '0')).join('');\n  return [uuid_str.slice(0, 8), uuid_str.slice(8, 12), uuid_str.slice(12, 16), uuid_str.slice(16, 20), uuid_str.slice(20)].join('-');\n}\nconst SERVICE_UUID = uuid_bytes_to_string([0xfb, 0x34, 0x9b, 0x5f, 0x80, 0x00, 0x00, 0x80, 0x00, 0x10, 0x00, 0x00, 0xFF, 0x00, 0x00, 0x00]);\nconst CHARACTERISTIC_UUID = '0000ff01-0000-1000-8000-00805f9b34fb';\nexport const BluetoothProvider = ({\n  children\n}) => {\n  _s();\n  const [bluetoothDevice, setBluetoothDevice] = useState(null);\n  const [outputText, setOutputText] = useState('');\n  //most recent time a disconnect call was made\n  const [lastDisconnectTime, setLastDisconnectTime] = useState(0);\n  const disconnectMessage = 'Disconnected from Bluetooth device.\\n';\n\n  // For writing to the output text\n  const writeToOutput = useCallback(data => {\n    // If the previous output ends with the disconnect message, and we are trying to write that same message again, don't write it\n    if (outputText.endsWith(disconnectMessage) && data === disconnectMessage) {\n      return;\n    }\n    print;\n    setOutputText(prevOutput => prevOutput + '\\n' + data);\n    console.log(\"Output: \" + data);\n  }, [setOutputText]);\n  const clearOutput = useCallback(() => {\n    setOutputText('');\n  }, [setOutputText]);\n  const handleDisconnected = useCallback(() => {\n    console.log('Disconnected from GATT server');\n    writeToOutput(disconnectMessage);\n  }, [writeToOutput, outputText]);\n\n  // useEffect(() => {\n  //   if (bluetoothDevice) {\n  //     bluetoothDevice.removeEventListener('gattserverdisconnected', handleDisconnected);\n  //     bluetoothDevice.addEventListener('gattserverdisconnected', handleDisconnected);\n  //   }\n\n  //   return () => {\n  //     if (bluetoothDevice) {\n  //       bluetoothDevice.removeEventListener('gattserverdisconnected', handleDisconnected);\n  //     }\n  //   };\n  // }, [bluetoothDevice, handleDisconnected]);\n\n  const connectToDevice = useCallback(async () => {\n    console.log('Requesting Bluetooth Device...');\n    try {\n      var _device$gatt;\n      if (!navigator.bluetooth) {\n        console.error('Web Bluetooth API is not available.\\n');\n        return;\n      }\n\n      // If the device is already connected, disconnect it\n      if (bluetoothDevice) {\n        return;\n      }\n      const device = await navigator.bluetooth.requestDevice({\n        filters: [{\n          services: [SERVICE_UUID]\n        }]\n      });\n      console.log('Connected to:', device.name);\n      const server = await ((_device$gatt = device.gatt) === null || _device$gatt === void 0 ? void 0 : _device$gatt.connect());\n      console.log('Connected to GATT server');\n\n      // Event listener for disconnection\n      device.addEventListener('gattserverdisconnected', handleDisconnected);\n      const service = await (server === null || server === void 0 ? void 0 : server.getPrimaryService(SERVICE_UUID));\n      console.log('Service discovered');\n      const char = await (service === null || service === void 0 ? void 0 : service.getCharacteristic(CHARACTERISTIC_UUID));\n      console.log('Read Characteristic discovered');\n      console.log(char);\n      if (char) {\n        // Enable notifications for the characteristic to receive data\n        await char.startNotifications();\n        console.log('Notifications started for read characteristic');\n\n        // Listen for data notifications\n        char.addEventListener('characteristicvaluechanged', event => {\n          var _event$target, _event$target2;\n          console.log('Received data:', (_event$target = event.target) === null || _event$target === void 0 ? void 0 : _event$target.value);\n          const value = (_event$target2 = event.target) === null || _event$target2 === void 0 ? void 0 : _event$target2.value;\n          if (value) {\n            const textDecoder = new TextDecoder('utf-8');\n            const decodedValue = textDecoder.decode(value);\n\n            // Decode the callbacks per callbacks.md\n\n            // __SS__\n            if (decodedValue === ScriptSentFlag) {\n              writeToOutput('Script uploaded.\\n');\n            }\n\n            // __P__<TEXT>__P__\n            else if (decodedValue.startsWith(PrintFlag) && decodedValue.endsWith(PrintFlag)) {\n              const text = decodedValue.slice(PrintFlagLength, decodedValue.length - PrintFlagLength);\n              writeToOutput(text + '\\n');\n            }\n\n            // __ER__<TEXT>__ER__\n            else if (decodedValue.startsWith(ErrorFlag) && decodedValue.endsWith(ErrorFlag)) {\n              const text = decodedValue.slice(ErrorFlagLength, decodedValue.length - ErrorFlagLength);\n              writeToOutput('Error: ' + text + '\\n');\n            }\n          }\n        });\n        setBluetoothDevice(device);\n        writeToOutput('Connected to Bluetooth device.\\n');\n      } else {\n        // Handle the case when the characteristic is not found\n        setBluetoothDevice(null);\n      }\n    } catch (error) {\n      console.error('Bluetooth error:', error);\n    }\n  }, [bluetoothDevice, writeToOutput]);\n  const disconnectDevice = useCallback(async () => {\n    var _bluetoothDevice$gatt;\n    if (bluetoothDevice && (_bluetoothDevice$gatt = bluetoothDevice.gatt) !== null && _bluetoothDevice$gatt !== void 0 && _bluetoothDevice$gatt.connected) {\n      var _bluetoothDevice$gatt2;\n      (_bluetoothDevice$gatt2 = bluetoothDevice.gatt) === null || _bluetoothDevice$gatt2 === void 0 ? void 0 : _bluetoothDevice$gatt2.disconnect();\n      console.log('Disconnected');\n    }\n    console.log('Disconnected from:', bluetoothDevice === null || bluetoothDevice === void 0 ? void 0 : bluetoothDevice.name);\n    setBluetoothDevice(null);\n  }, [bluetoothDevice]);\n  const sendBluetoothData = useCallback(async data => {\n    if (bluetoothDevice) {\n      var _bluetoothDevice$gatt3;\n      const textEncoder = new TextEncoder();\n      const encodedData = textEncoder.encode(data);\n\n      // Update the characteristic UUID to match the one used in your ESP32 code\n      const service = await ((_bluetoothDevice$gatt3 = bluetoothDevice.gatt) === null || _bluetoothDevice$gatt3 === void 0 ? void 0 : _bluetoothDevice$gatt3.getPrimaryService(SERVICE_UUID));\n      const writeChar = await (service === null || service === void 0 ? void 0 : service.getCharacteristic(CHARACTERISTIC_UUID));\n      console.log('Sending data:', data);\n      if (writeChar) {\n        try {\n          await writeChar.writeValue(encodedData);\n          console.log('Write successful');\n        } catch (error) {\n          console.error('Write error:', error);\n        }\n      }\n    }\n  }, [bluetoothDevice]);\n  return /*#__PURE__*/_jsxDEV(BluetoothContext.Provider, {\n    value: {\n      bluetoothDevice,\n      outputText,\n      connectToDevice,\n      disconnectDevice,\n      sendBluetoothData,\n      writeToOutput,\n      clearOutput\n    },\n    children: children\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 208,\n    columnNumber: 5\n  }, this);\n};\n_s(BluetoothProvider, \"MU4TNJj/bkRaDSA18H/4hsa3yZQ=\");\n_c = BluetoothProvider;\nexport const useBluetooth = () => {\n  _s2();\n  const context = useContext(BluetoothContext);\n  if (context === undefined) {\n    throw new Error('useBluetooth must be used within a BluetoothProvider');\n  }\n  return context;\n};\n_s2(useBluetooth, \"b9L3QQ+jgeyIrH0NfHrJ8nn7VMU=\");\nvar _c;\n$RefreshReg$(_c, \"BluetoothProvider\");","map":{"version":3,"names":["React","createContext","useContext","useState","useCallback","jsxDEV","_jsxDEV","BluetoothContext","undefined","PrintFlag","PrintFlagLength","length","ErrorFlag","ErrorFlagLength","ScriptSentFlag","uuid_bytes_to_string","uuid","uuid_str","reverse","map","byte","toString","padStart","join","slice","SERVICE_UUID","CHARACTERISTIC_UUID","BluetoothProvider","children","_s","bluetoothDevice","setBluetoothDevice","outputText","setOutputText","lastDisconnectTime","setLastDisconnectTime","disconnectMessage","writeToOutput","data","endsWith","print","prevOutput","console","log","clearOutput","handleDisconnected","connectToDevice","_device$gatt","navigator","bluetooth","error","device","requestDevice","filters","services","name","server","gatt","connect","addEventListener","service","getPrimaryService","char","getCharacteristic","startNotifications","event","_event$target","_event$target2","target","value","textDecoder","TextDecoder","decodedValue","decode","startsWith","text","disconnectDevice","_bluetoothDevice$gatt","connected","_bluetoothDevice$gatt2","disconnect","sendBluetoothData","_bluetoothDevice$gatt3","textEncoder","TextEncoder","encodedData","encode","writeChar","writeValue","Provider","fileName","_jsxFileName","lineNumber","columnNumber","_c","useBluetooth","_s2","context","Error","$RefreshReg$"],"sources":["/Users/michaelbryant/Desktop/Littlearn/web/src/BluetoothContext.tsx"],"sourcesContent":["import React, { createContext, useContext, useState, useCallback, ReactNode, useEffect } from 'react';\n\ninterface BluetoothContextProps {\n  bluetoothDevice: BluetoothDevice | null;\n  outputText: string;\n  connectToDevice: () => Promise<void>;\n  disconnectDevice: () => Promise<void>;\n  sendBluetoothData: (data: string) => Promise<void>;\n  writeToOutput: (data: string) => void;\n  clearOutput: () => void;\n}\n\nconst BluetoothContext = createContext<BluetoothContextProps | undefined>(undefined);\n\nconst PrintFlag = '__P__';\nconst PrintFlagLength = PrintFlag.length;\n\nconst ErrorFlag = '__ER__';\nconst ErrorFlagLength = ErrorFlag.length;\n\nconst ScriptSentFlag = '__SS__';\n\nfunction uuid_bytes_to_string(uuid: number[]): string {\n  // Assumes LSB first\n  const uuid_str = uuid.reverse().map(byte => byte.toString(16).padStart(2, '0')).join('');\n  return [\n    uuid_str.slice(0, 8),\n    uuid_str.slice(8, 12),\n    uuid_str.slice(12, 16),\n    uuid_str.slice(16, 20),\n    uuid_str.slice(20),\n  ].join('-');\n}\n\nconst SERVICE_UUID = uuid_bytes_to_string([\n  0xfb, 0x34, 0x9b, 0x5f, 0x80, 0x00, 0x00, 0x80,\n  0x00, 0x10, 0x00, 0x00, 0xFF, 0x00, 0x00, 0x00,\n]);\n\nconst CHARACTERISTIC_UUID = '0000ff01-0000-1000-8000-00805f9b34fb';\n\ninterface BluetoothProviderProps {\n  children: ReactNode;\n}\n\nexport const BluetoothProvider: React.FC<BluetoothProviderProps> = ({ children }) => {\n  const [bluetoothDevice, setBluetoothDevice] = useState<BluetoothDevice | null>(null);\n  const [outputText, setOutputText] = useState<string>('');\n  //most recent time a disconnect call was made\n  const [lastDisconnectTime, setLastDisconnectTime] = useState<number>(0);\n\n  const disconnectMessage = 'Disconnected from Bluetooth device.\\n';\n\n  // For writing to the output text\n  const writeToOutput = useCallback((data: string) => {\n\n    // If the previous output ends with the disconnect message, and we are trying to write that same message again, don't write it\n    if (outputText.endsWith(disconnectMessage) && data === disconnectMessage) {\n      return;\n    }\n\n    print\n\n    setOutputText((prevOutput) => prevOutput + '\\n' + data);\n    console.log(\"Output: \" + data);\n  }, [setOutputText]);\n\n  const clearOutput = useCallback(() => {\n    setOutputText('');\n  }, [setOutputText]);\n\n  const handleDisconnected = useCallback(() => {\n\n    console.log('Disconnected from GATT server');\n    writeToOutput(disconnectMessage);\n\n  }, [writeToOutput, outputText]);\n\n  // useEffect(() => {\n  //   if (bluetoothDevice) {\n  //     bluetoothDevice.removeEventListener('gattserverdisconnected', handleDisconnected);\n  //     bluetoothDevice.addEventListener('gattserverdisconnected', handleDisconnected);\n  //   }\n  \n  //   return () => {\n  //     if (bluetoothDevice) {\n  //       bluetoothDevice.removeEventListener('gattserverdisconnected', handleDisconnected);\n  //     }\n  //   };\n  // }, [bluetoothDevice, handleDisconnected]);\n  \n\n  const connectToDevice = useCallback(async () => {\n\n    console.log('Requesting Bluetooth Device...');\n\n    try {\n\n      if (!navigator.bluetooth) {\n        console.error('Web Bluetooth API is not available.\\n');\n        return;\n      }\n\n      // If the device is already connected, disconnect it\n      if (bluetoothDevice) { return; }\n\n      const device = await navigator.bluetooth.requestDevice({\n        filters: [{ services: [SERVICE_UUID] }],\n      });\n\n      console.log('Connected to:', device.name);\n\n      const server = await device.gatt?.connect();\n      console.log('Connected to GATT server');\n\n      // Event listener for disconnection\n      device.addEventListener('gattserverdisconnected', handleDisconnected);\n\n      const service = await server?.getPrimaryService(SERVICE_UUID);\n      console.log('Service discovered');\n\n      const char = await service?.getCharacteristic(CHARACTERISTIC_UUID);\n      console.log('Read Characteristic discovered');\n\n      console.log(char);\n\n      if (char) {\n        // Enable notifications for the characteristic to receive data\n        await char.startNotifications();\n        console.log('Notifications started for read characteristic');\n\n        // Listen for data notifications\n        char.addEventListener('characteristicvaluechanged', (event: any) => {\n          console.log('Received data:', event.target?.value);\n          const value = event.target?.value;\n          if (value) {\n            const textDecoder = new TextDecoder('utf-8');\n            const decodedValue = textDecoder.decode(value);\n\n            // Decode the callbacks per callbacks.md\n\n            // __SS__\n            if (decodedValue === ScriptSentFlag) {\n              writeToOutput('Script uploaded.\\n');\n            }\n\n            // __P__<TEXT>__P__\n            else if (decodedValue.startsWith(PrintFlag) && decodedValue.endsWith(PrintFlag)) {\n              const text = decodedValue.slice(PrintFlagLength, decodedValue.length - PrintFlagLength);\n              writeToOutput(text + '\\n');\n            }\n\n            // __ER__<TEXT>__ER__\n            else if (decodedValue.startsWith(ErrorFlag) && decodedValue.endsWith(ErrorFlag)) {\n              const text = decodedValue.slice(ErrorFlagLength, decodedValue.length - ErrorFlagLength);\n              writeToOutput('Error: ' + text + '\\n');\n            }\n          }\n        });\n\n        setBluetoothDevice(device);\n        writeToOutput('Connected to Bluetooth device.\\n');\n      } else {\n        // Handle the case when the characteristic is not found\n        setBluetoothDevice(null);\n      }\n    } catch (error) {\n      console.error('Bluetooth error:', error);\n    }\n  }, [bluetoothDevice, writeToOutput]);\n\n  const disconnectDevice = useCallback(async () => {\n\n    if (bluetoothDevice && bluetoothDevice.gatt?.connected) {\n      bluetoothDevice.gatt?.disconnect();\n      console.log('Disconnected');\n    }\n\n    console.log('Disconnected from:', bluetoothDevice?.name);\n\n    setBluetoothDevice(null);\n\n  }, [bluetoothDevice]);\n\n  const sendBluetoothData = useCallback(async (data: string) => {\n    if (bluetoothDevice) {\n        const textEncoder = new TextEncoder();\n        const encodedData = textEncoder.encode(data);\n        \n        // Update the characteristic UUID to match the one used in your ESP32 code\n        const service = await bluetoothDevice.gatt?.getPrimaryService(SERVICE_UUID);\n        const writeChar = await service?.getCharacteristic(CHARACTERISTIC_UUID);\n\n        console.log('Sending data:', data);\n\n        if (writeChar) {\n            try {\n                await writeChar.writeValue(encodedData);\n                console.log('Write successful');\n            } catch (error) {\n                console.error('Write error:', error);\n            }\n        }\n    }\n  }, [bluetoothDevice]);\n\n  return (\n    <BluetoothContext.Provider\n      value={{\n        bluetoothDevice,\n        outputText,\n        connectToDevice,\n        disconnectDevice,\n        sendBluetoothData,\n        writeToOutput,\n        clearOutput,\n      }}\n    >\n      {children}\n    </BluetoothContext.Provider>\n  );\n};\n\nexport const useBluetooth = (): BluetoothContextProps => {\n  const context = useContext(BluetoothContext);\n  if (context === undefined) {\n    throw new Error('useBluetooth must be used within a BluetoothProvider');\n  }\n  return context;\n};\n\n"],"mappings":";;;AAAA,OAAOA,KAAK,IAAIC,aAAa,EAAEC,UAAU,EAAEC,QAAQ,EAAEC,WAAW,QAA8B,OAAO;AAAC,SAAAC,MAAA,IAAAC,OAAA;AAYtG,MAAMC,gBAAgB,gBAAGN,aAAa,CAAoCO,SAAS,CAAC;AAEpF,MAAMC,SAAS,GAAG,OAAO;AACzB,MAAMC,eAAe,GAAGD,SAAS,CAACE,MAAM;AAExC,MAAMC,SAAS,GAAG,QAAQ;AAC1B,MAAMC,eAAe,GAAGD,SAAS,CAACD,MAAM;AAExC,MAAMG,cAAc,GAAG,QAAQ;AAE/B,SAASC,oBAAoBA,CAACC,IAAc,EAAU;EACpD;EACA,MAAMC,QAAQ,GAAGD,IAAI,CAACE,OAAO,CAAC,CAAC,CAACC,GAAG,CAACC,IAAI,IAAIA,IAAI,CAACC,QAAQ,CAAC,EAAE,CAAC,CAACC,QAAQ,CAAC,CAAC,EAAE,GAAG,CAAC,CAAC,CAACC,IAAI,CAAC,EAAE,CAAC;EACxF,OAAO,CACLN,QAAQ,CAACO,KAAK,CAAC,CAAC,EAAE,CAAC,CAAC,EACpBP,QAAQ,CAACO,KAAK,CAAC,CAAC,EAAE,EAAE,CAAC,EACrBP,QAAQ,CAACO,KAAK,CAAC,EAAE,EAAE,EAAE,CAAC,EACtBP,QAAQ,CAACO,KAAK,CAAC,EAAE,EAAE,EAAE,CAAC,EACtBP,QAAQ,CAACO,KAAK,CAAC,EAAE,CAAC,CACnB,CAACD,IAAI,CAAC,GAAG,CAAC;AACb;AAEA,MAAME,YAAY,GAAGV,oBAAoB,CAAC,CACxC,IAAI,EAAE,IAAI,EAAE,IAAI,EAAE,IAAI,EAAE,IAAI,EAAE,IAAI,EAAE,IAAI,EAAE,IAAI,EAC9C,IAAI,EAAE,IAAI,EAAE,IAAI,EAAE,IAAI,EAAE,IAAI,EAAE,IAAI,EAAE,IAAI,EAAE,IAAI,CAC/C,CAAC;AAEF,MAAMW,mBAAmB,GAAG,sCAAsC;AAMlE,OAAO,MAAMC,iBAAmD,GAAGA,CAAC;EAAEC;AAAS,CAAC,KAAK;EAAAC,EAAA;EACnF,MAAM,CAACC,eAAe,EAAEC,kBAAkB,CAAC,GAAG5B,QAAQ,CAAyB,IAAI,CAAC;EACpF,MAAM,CAAC6B,UAAU,EAAEC,aAAa,CAAC,GAAG9B,QAAQ,CAAS,EAAE,CAAC;EACxD;EACA,MAAM,CAAC+B,kBAAkB,EAAEC,qBAAqB,CAAC,GAAGhC,QAAQ,CAAS,CAAC,CAAC;EAEvE,MAAMiC,iBAAiB,GAAG,uCAAuC;;EAEjE;EACA,MAAMC,aAAa,GAAGjC,WAAW,CAAEkC,IAAY,IAAK;IAElD;IACA,IAAIN,UAAU,CAACO,QAAQ,CAACH,iBAAiB,CAAC,IAAIE,IAAI,KAAKF,iBAAiB,EAAE;MACxE;IACF;IAEAI,KAAK;IAELP,aAAa,CAAEQ,UAAU,IAAKA,UAAU,GAAG,IAAI,GAAGH,IAAI,CAAC;IACvDI,OAAO,CAACC,GAAG,CAAC,UAAU,GAAGL,IAAI,CAAC;EAChC,CAAC,EAAE,CAACL,aAAa,CAAC,CAAC;EAEnB,MAAMW,WAAW,GAAGxC,WAAW,CAAC,MAAM;IACpC6B,aAAa,CAAC,EAAE,CAAC;EACnB,CAAC,EAAE,CAACA,aAAa,CAAC,CAAC;EAEnB,MAAMY,kBAAkB,GAAGzC,WAAW,CAAC,MAAM;IAE3CsC,OAAO,CAACC,GAAG,CAAC,+BAA+B,CAAC;IAC5CN,aAAa,CAACD,iBAAiB,CAAC;EAElC,CAAC,EAAE,CAACC,aAAa,EAAEL,UAAU,CAAC,CAAC;;EAE/B;EACA;EACA;EACA;EACA;;EAEA;EACA;EACA;EACA;EACA;EACA;;EAGA,MAAMc,eAAe,GAAG1C,WAAW,CAAC,YAAY;IAE9CsC,OAAO,CAACC,GAAG,CAAC,gCAAgC,CAAC;IAE7C,IAAI;MAAA,IAAAI,YAAA;MAEF,IAAI,CAACC,SAAS,CAACC,SAAS,EAAE;QACxBP,OAAO,CAACQ,KAAK,CAAC,uCAAuC,CAAC;QACtD;MACF;;MAEA;MACA,IAAIpB,eAAe,EAAE;QAAE;MAAQ;MAE/B,MAAMqB,MAAM,GAAG,MAAMH,SAAS,CAACC,SAAS,CAACG,aAAa,CAAC;QACrDC,OAAO,EAAE,CAAC;UAAEC,QAAQ,EAAE,CAAC7B,YAAY;QAAE,CAAC;MACxC,CAAC,CAAC;MAEFiB,OAAO,CAACC,GAAG,CAAC,eAAe,EAAEQ,MAAM,CAACI,IAAI,CAAC;MAEzC,MAAMC,MAAM,GAAG,QAAAT,YAAA,GAAMI,MAAM,CAACM,IAAI,cAAAV,YAAA,uBAAXA,YAAA,CAAaW,OAAO,CAAC,CAAC;MAC3ChB,OAAO,CAACC,GAAG,CAAC,0BAA0B,CAAC;;MAEvC;MACAQ,MAAM,CAACQ,gBAAgB,CAAC,wBAAwB,EAAEd,kBAAkB,CAAC;MAErE,MAAMe,OAAO,GAAG,OAAMJ,MAAM,aAANA,MAAM,uBAANA,MAAM,CAAEK,iBAAiB,CAACpC,YAAY,CAAC;MAC7DiB,OAAO,CAACC,GAAG,CAAC,oBAAoB,CAAC;MAEjC,MAAMmB,IAAI,GAAG,OAAMF,OAAO,aAAPA,OAAO,uBAAPA,OAAO,CAAEG,iBAAiB,CAACrC,mBAAmB,CAAC;MAClEgB,OAAO,CAACC,GAAG,CAAC,gCAAgC,CAAC;MAE7CD,OAAO,CAACC,GAAG,CAACmB,IAAI,CAAC;MAEjB,IAAIA,IAAI,EAAE;QACR;QACA,MAAMA,IAAI,CAACE,kBAAkB,CAAC,CAAC;QAC/BtB,OAAO,CAACC,GAAG,CAAC,+CAA+C,CAAC;;QAE5D;QACAmB,IAAI,CAACH,gBAAgB,CAAC,4BAA4B,EAAGM,KAAU,IAAK;UAAA,IAAAC,aAAA,EAAAC,cAAA;UAClEzB,OAAO,CAACC,GAAG,CAAC,gBAAgB,GAAAuB,aAAA,GAAED,KAAK,CAACG,MAAM,cAAAF,aAAA,uBAAZA,aAAA,CAAcG,KAAK,CAAC;UAClD,MAAMA,KAAK,IAAAF,cAAA,GAAGF,KAAK,CAACG,MAAM,cAAAD,cAAA,uBAAZA,cAAA,CAAcE,KAAK;UACjC,IAAIA,KAAK,EAAE;YACT,MAAMC,WAAW,GAAG,IAAIC,WAAW,CAAC,OAAO,CAAC;YAC5C,MAAMC,YAAY,GAAGF,WAAW,CAACG,MAAM,CAACJ,KAAK,CAAC;;YAE9C;;YAEA;YACA,IAAIG,YAAY,KAAK1D,cAAc,EAAE;cACnCuB,aAAa,CAAC,oBAAoB,CAAC;YACrC;;YAEA;YAAA,KACK,IAAImC,YAAY,CAACE,UAAU,CAACjE,SAAS,CAAC,IAAI+D,YAAY,CAACjC,QAAQ,CAAC9B,SAAS,CAAC,EAAE;cAC/E,MAAMkE,IAAI,GAAGH,YAAY,CAAChD,KAAK,CAACd,eAAe,EAAE8D,YAAY,CAAC7D,MAAM,GAAGD,eAAe,CAAC;cACvF2B,aAAa,CAACsC,IAAI,GAAG,IAAI,CAAC;YAC5B;;YAEA;YAAA,KACK,IAAIH,YAAY,CAACE,UAAU,CAAC9D,SAAS,CAAC,IAAI4D,YAAY,CAACjC,QAAQ,CAAC3B,SAAS,CAAC,EAAE;cAC/E,MAAM+D,IAAI,GAAGH,YAAY,CAAChD,KAAK,CAACX,eAAe,EAAE2D,YAAY,CAAC7D,MAAM,GAAGE,eAAe,CAAC;cACvFwB,aAAa,CAAC,SAAS,GAAGsC,IAAI,GAAG,IAAI,CAAC;YACxC;UACF;QACF,CAAC,CAAC;QAEF5C,kBAAkB,CAACoB,MAAM,CAAC;QAC1Bd,aAAa,CAAC,kCAAkC,CAAC;MACnD,CAAC,MAAM;QACL;QACAN,kBAAkB,CAAC,IAAI,CAAC;MAC1B;IACF,CAAC,CAAC,OAAOmB,KAAK,EAAE;MACdR,OAAO,CAACQ,KAAK,CAAC,kBAAkB,EAAEA,KAAK,CAAC;IAC1C;EACF,CAAC,EAAE,CAACpB,eAAe,EAAEO,aAAa,CAAC,CAAC;EAEpC,MAAMuC,gBAAgB,GAAGxE,WAAW,CAAC,YAAY;IAAA,IAAAyE,qBAAA;IAE/C,IAAI/C,eAAe,KAAA+C,qBAAA,GAAI/C,eAAe,CAAC2B,IAAI,cAAAoB,qBAAA,eAApBA,qBAAA,CAAsBC,SAAS,EAAE;MAAA,IAAAC,sBAAA;MACtD,CAAAA,sBAAA,GAAAjD,eAAe,CAAC2B,IAAI,cAAAsB,sBAAA,uBAApBA,sBAAA,CAAsBC,UAAU,CAAC,CAAC;MAClCtC,OAAO,CAACC,GAAG,CAAC,cAAc,CAAC;IAC7B;IAEAD,OAAO,CAACC,GAAG,CAAC,oBAAoB,EAAEb,eAAe,aAAfA,eAAe,uBAAfA,eAAe,CAAEyB,IAAI,CAAC;IAExDxB,kBAAkB,CAAC,IAAI,CAAC;EAE1B,CAAC,EAAE,CAACD,eAAe,CAAC,CAAC;EAErB,MAAMmD,iBAAiB,GAAG7E,WAAW,CAAC,MAAOkC,IAAY,IAAK;IAC5D,IAAIR,eAAe,EAAE;MAAA,IAAAoD,sBAAA;MACjB,MAAMC,WAAW,GAAG,IAAIC,WAAW,CAAC,CAAC;MACrC,MAAMC,WAAW,GAAGF,WAAW,CAACG,MAAM,CAAChD,IAAI,CAAC;;MAE5C;MACA,MAAMsB,OAAO,GAAG,QAAAsB,sBAAA,GAAMpD,eAAe,CAAC2B,IAAI,cAAAyB,sBAAA,uBAApBA,sBAAA,CAAsBrB,iBAAiB,CAACpC,YAAY,CAAC;MAC3E,MAAM8D,SAAS,GAAG,OAAM3B,OAAO,aAAPA,OAAO,uBAAPA,OAAO,CAAEG,iBAAiB,CAACrC,mBAAmB,CAAC;MAEvEgB,OAAO,CAACC,GAAG,CAAC,eAAe,EAAEL,IAAI,CAAC;MAElC,IAAIiD,SAAS,EAAE;QACX,IAAI;UACA,MAAMA,SAAS,CAACC,UAAU,CAACH,WAAW,CAAC;UACvC3C,OAAO,CAACC,GAAG,CAAC,kBAAkB,CAAC;QACnC,CAAC,CAAC,OAAOO,KAAK,EAAE;UACZR,OAAO,CAACQ,KAAK,CAAC,cAAc,EAAEA,KAAK,CAAC;QACxC;MACJ;IACJ;EACF,CAAC,EAAE,CAACpB,eAAe,CAAC,CAAC;EAErB,oBACExB,OAAA,CAACC,gBAAgB,CAACkF,QAAQ;IACxBpB,KAAK,EAAE;MACLvC,eAAe;MACfE,UAAU;MACVc,eAAe;MACf8B,gBAAgB;MAChBK,iBAAiB;MACjB5C,aAAa;MACbO;IACF,CAAE;IAAAhB,QAAA,EAEDA;EAAQ;IAAA8D,QAAA,EAAAC,YAAA;IAAAC,UAAA;IAAAC,YAAA;EAAA,OACgB,CAAC;AAEhC,CAAC;AAAChE,EAAA,CAhLWF,iBAAmD;AAAAmE,EAAA,GAAnDnE,iBAAmD;AAkLhE,OAAO,MAAMoE,YAAY,GAAGA,CAAA,KAA6B;EAAAC,GAAA;EACvD,MAAMC,OAAO,GAAG/F,UAAU,CAACK,gBAAgB,CAAC;EAC5C,IAAI0F,OAAO,KAAKzF,SAAS,EAAE;IACzB,MAAM,IAAI0F,KAAK,CAAC,sDAAsD,CAAC;EACzE;EACA,OAAOD,OAAO;AAChB,CAAC;AAACD,GAAA,CANWD,YAAY;AAAA,IAAAD,EAAA;AAAAK,YAAA,CAAAL,EAAA"},"metadata":{},"sourceType":"module","externalDependencies":[]}