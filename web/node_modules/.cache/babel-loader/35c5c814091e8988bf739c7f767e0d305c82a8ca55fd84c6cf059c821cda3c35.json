{"ast":null,"code":"'use strict';\n\nvar util = require('util');\nvar _require = require('triple-beam'),\n  LEVEL = _require.LEVEL;\nvar TransportStream = require('./modern');\n\n/**\n * Constructor function for the LegacyTransportStream. This is an internal\n * wrapper `winston >= 3` uses to wrap older transports implementing\n * log(level, message, meta).\n * @param {Object} options - Options for this TransportStream instance.\n * @param {Transpot} options.transport - winston@2 or older Transport to wrap.\n */\n\nvar LegacyTransportStream = module.exports = function LegacyTransportStream() {\n  var options = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n  TransportStream.call(this, options);\n  if (!options.transport || typeof options.transport.log !== 'function') {\n    throw new Error('Invalid transport, must be an object with a log method.');\n  }\n  this.transport = options.transport;\n  this.level = this.level || options.transport.level;\n  this.handleExceptions = this.handleExceptions || options.transport.handleExceptions;\n\n  // Display our deprecation notice.\n  this._deprecated();\n\n  // Properly bubble up errors from the transport to the\n  // LegacyTransportStream instance, but only once no matter how many times\n  // this transport is shared.\n  function transportError(err) {\n    this.emit('error', err, this.transport);\n  }\n  if (!this.transport.__winstonError) {\n    this.transport.__winstonError = transportError.bind(this);\n    this.transport.on('error', this.transport.__winstonError);\n  }\n};\n\n/*\n * Inherit from TransportStream using Node.js built-ins\n */\nutil.inherits(LegacyTransportStream, TransportStream);\n\n/**\n * Writes the info object to our transport instance.\n * @param {mixed} info - TODO: add param description.\n * @param {mixed} enc - TODO: add param description.\n * @param {function} callback - TODO: add param description.\n * @returns {undefined}\n * @private\n */\nLegacyTransportStream.prototype._write = function _write(info, enc, callback) {\n  if (this.silent || info.exception === true && !this.handleExceptions) {\n    return callback(null);\n  }\n\n  // Remark: This has to be handled in the base transport now because we\n  // cannot conditionally write to our pipe targets as stream.\n  if (!this.level || this.levels[this.level] >= this.levels[info[LEVEL]]) {\n    this.transport.log(info[LEVEL], info.message, info, this._nop);\n  }\n  callback(null);\n};\n\n/**\n * Writes the batch of info objects (i.e. \"object chunks\") to our transport\n * instance after performing any necessary filtering.\n * @param {mixed} chunks - TODO: add params description.\n * @param {function} callback - TODO: add params description.\n * @returns {mixed} - TODO: add returns description.\n * @private\n */\nLegacyTransportStream.prototype._writev = function _writev(chunks, callback) {\n  for (var i = 0; i < chunks.length; i++) {\n    if (this._accept(chunks[i])) {\n      this.transport.log(chunks[i].chunk[LEVEL], chunks[i].chunk.message, chunks[i].chunk, this._nop);\n      chunks[i].callback();\n    }\n  }\n  return callback(null);\n};\n\n/**\n * Displays a deprecation notice. Defined as a function so it can be\n * overriden in tests.\n * @returns {undefined}\n */\nLegacyTransportStream.prototype._deprecated = function _deprecated() {\n  // eslint-disable-next-line no-console\n  console.error([this.transport.name + ' is a legacy winston transport. Consider upgrading: ', '- Upgrade docs: https://github.com/winstonjs/winston/blob/master/UPGRADE-3.0.md'].join('\\n'));\n};\n\n/**\n * Clean up error handling state on the legacy transport associated\n * with this instance.\n * @returns {undefined}\n */\nLegacyTransportStream.prototype.close = function close() {\n  if (this.transport.close) {\n    this.transport.close();\n  }\n  if (this.transport.__winstonError) {\n    this.transport.removeListener('error', this.transport.__winstonError);\n    this.transport.__winstonError = null;\n  }\n};","map":{"version":3,"names":["util","require","_require","LEVEL","TransportStream","LegacyTransportStream","module","exports","options","arguments","length","undefined","call","transport","log","Error","level","handleExceptions","_deprecated","transportError","err","emit","__winstonError","bind","on","inherits","prototype","_write","info","enc","callback","silent","exception","levels","message","_nop","_writev","chunks","i","_accept","chunk","console","error","name","join","close","removeListener"],"sources":["/Users/michaelbryant/node_modules/winston-transport/dist/legacy.js"],"sourcesContent":["'use strict';\n\nvar util = require('util');\n\nvar _require = require('triple-beam'),\n    LEVEL = _require.LEVEL;\n\nvar TransportStream = require('./modern');\n\n/**\n * Constructor function for the LegacyTransportStream. This is an internal\n * wrapper `winston >= 3` uses to wrap older transports implementing\n * log(level, message, meta).\n * @param {Object} options - Options for this TransportStream instance.\n * @param {Transpot} options.transport - winston@2 or older Transport to wrap.\n */\n\nvar LegacyTransportStream = module.exports = function LegacyTransportStream() {\n  var options = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n\n  TransportStream.call(this, options);\n  if (!options.transport || typeof options.transport.log !== 'function') {\n    throw new Error('Invalid transport, must be an object with a log method.');\n  }\n\n  this.transport = options.transport;\n  this.level = this.level || options.transport.level;\n  this.handleExceptions = this.handleExceptions || options.transport.handleExceptions;\n\n  // Display our deprecation notice.\n  this._deprecated();\n\n  // Properly bubble up errors from the transport to the\n  // LegacyTransportStream instance, but only once no matter how many times\n  // this transport is shared.\n  function transportError(err) {\n    this.emit('error', err, this.transport);\n  }\n\n  if (!this.transport.__winstonError) {\n    this.transport.__winstonError = transportError.bind(this);\n    this.transport.on('error', this.transport.__winstonError);\n  }\n};\n\n/*\n * Inherit from TransportStream using Node.js built-ins\n */\nutil.inherits(LegacyTransportStream, TransportStream);\n\n/**\n * Writes the info object to our transport instance.\n * @param {mixed} info - TODO: add param description.\n * @param {mixed} enc - TODO: add param description.\n * @param {function} callback - TODO: add param description.\n * @returns {undefined}\n * @private\n */\nLegacyTransportStream.prototype._write = function _write(info, enc, callback) {\n  if (this.silent || info.exception === true && !this.handleExceptions) {\n    return callback(null);\n  }\n\n  // Remark: This has to be handled in the base transport now because we\n  // cannot conditionally write to our pipe targets as stream.\n  if (!this.level || this.levels[this.level] >= this.levels[info[LEVEL]]) {\n    this.transport.log(info[LEVEL], info.message, info, this._nop);\n  }\n\n  callback(null);\n};\n\n/**\n * Writes the batch of info objects (i.e. \"object chunks\") to our transport\n * instance after performing any necessary filtering.\n * @param {mixed} chunks - TODO: add params description.\n * @param {function} callback - TODO: add params description.\n * @returns {mixed} - TODO: add returns description.\n * @private\n */\nLegacyTransportStream.prototype._writev = function _writev(chunks, callback) {\n  for (var i = 0; i < chunks.length; i++) {\n    if (this._accept(chunks[i])) {\n      this.transport.log(chunks[i].chunk[LEVEL], chunks[i].chunk.message, chunks[i].chunk, this._nop);\n      chunks[i].callback();\n    }\n  }\n\n  return callback(null);\n};\n\n/**\n * Displays a deprecation notice. Defined as a function so it can be\n * overriden in tests.\n * @returns {undefined}\n */\nLegacyTransportStream.prototype._deprecated = function _deprecated() {\n  // eslint-disable-next-line no-console\n  console.error([this.transport.name + ' is a legacy winston transport. Consider upgrading: ', '- Upgrade docs: https://github.com/winstonjs/winston/blob/master/UPGRADE-3.0.md'].join('\\n'));\n};\n\n/**\n * Clean up error handling state on the legacy transport associated\n * with this instance.\n * @returns {undefined}\n */\nLegacyTransportStream.prototype.close = function close() {\n  if (this.transport.close) {\n    this.transport.close();\n  }\n\n  if (this.transport.__winstonError) {\n    this.transport.removeListener('error', this.transport.__winstonError);\n    this.transport.__winstonError = null;\n  }\n};"],"mappings":"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"},"metadata":{},"sourceType":"script","externalDependencies":[]}